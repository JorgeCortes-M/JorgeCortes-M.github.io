---
title: 'Paquete Dplyr en R y su uso para el manejo de datos'
date: 2022-10-10
permalink: /posts/2022/10/Dplyr-R/
code-block-font-size: \large
tags:
  - R
  - RStudio
  - Data Analysis
  - dplyr
---

# ¿Análisis de datos? dplyr es tu aliado

Una de las herramientas más usadas para el análisis de datos es R, este software cuenta con funciones nativas que nos pueden ayudar a la hora de limpiar o querer extraer alguna información de nuestros conjuntos de datos. Sin embargo, muchas de estas operaciones pueden ser tediosas de escribir, para demostrarlo usaremos un set de datos de Kaggle sobre [población humana](https://www.kaggle.com/datasets/iamsouravbanerjee/world-population-dataset). Luego de descargar el archivo .csv procederemos a cargarlo en RStudio.

```R
library(readr)
popData <- read_csv(file = "./world_pop/world_population.csv")
```

Imaginemos que deseamos el ranking y la abreviatura de Chile, para el caso del código nativo de R, esto se haría así:
```R
popData[which(popData$Country == "Chile"), names(popData) %in% c("Rank", "CCA3")]
```

Mientras que con dplyr haríamos esto:
```R
popData %>%
filter(Country=="Chile")%>%
select(Rank,CCA3)
```
En el paquete dplyr existen diversas funciones que nos ayudarán a manipular nuestros dataframes, las cuales podemos dividir en funciones para resumir la información (summarise, count), para agrupar casos (group_by, rowwise, ungroup), Manipular casos (filter, distinct, slice, slice_sample, slice_min, slice_head, arrange, add_row), Manipular variables (pull, select, relocate, across, c_across, mutate, transmute, rename). Revisemos algunas de estas funciones.

El primer elemento que nos aporta dplyr y no mencioné antes es la tubería o pipe (%>%) podemos concatenar los resultados de una función y aplicarle otra directamente.

```R
head(popData) # Sin uso de pipe

popData %>%
  head() # Con uso de pipe

```
Ahora si, vamos a las funciones de Dplyr, partiremos por select(), esta nos permite seleccionar columnas de nuestro data frame indicando su nombre. Veamos, seleccionemos los continentes de nuestro data set. 
```R
popData %>%
  select(Continent)

```
Esto nos genera un dataframe de una única columna con los continentes. ![Filtrado por continentes](https://github.com/JorgeCortes-M/JorgeCortes-M.github.io/images/select_continent_blog_1.JPG)

También podemos seleccionar más de una columna y renombrar la columna Growth Rate. 
```R
popData %>%
  select(Country, Continent, Growth_Rate = 'Growth Rate')
```
Ahora tenemos un data frame con tres columnas. ![Data Frame con dos columnas](https://github.com/JorgeCortes-M/JorgeCortes-M.github.io/images/select_mult_col_blog_1.JPG)

También podemos cambiar el nombre a una columna llamando a la función rename de dplyr, de esta forma:

```R
popData %>%
  select(Country, Continent, 'Growth Rate') %>%
  rename(Growth_Rate = 'Growth Rate')

```
Como ves no hay una sola forma de llevar a cabo estas tareas y la utilización de la tubería %>% facilita mucho usar una función tras otra.

Otra cosa que podemos hacer con select es utilizar funciones ayudantes o helper, en este caso usamos ends_with para seleccionar todas las columnas que terminen con "Population":

```R
popData %>%
  select(ends_with("Population"))

```

Así obtenemos el siguiente dataframe ![Data frame ends_with](https://github.com/JorgeCortes-M/JorgeCortes-M.github.io/images/select_ends_with.JPG)

La segunda función que veremos brevemente es relocate, la cual como su nombre dice nos permite cambiar el orden de una columna en el data frame.

Podemos por ejemplo indicar que la columna Country quede como la última utilizando el parámetro .after, podríamos dejarla antes de la última también cambiando after por before. Incluso podemos hacer referencia a otra columna para posicionar la columna objetivo, pongamos Country luego de Continent.
======

You can have many headings
======

Aren't headings cool?
------